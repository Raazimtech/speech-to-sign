<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Speech to Sign converts spoken or typed words into sign-language visuals with GIF playback and smart fallback modes.">
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1">
  <meta name="googlebot" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1">
  <meta name="author" content="RT Solutions">
  <meta name="format-detection" content="telephone=no">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Speech to Sign">
  <meta property="og:title" content="Speech to Sign">
  <meta property="og:description" content="Convert speech and text to sign visuals instantly.">
  <meta property="og:url" content="./">
  <meta property="og:locale" content="en_US">
  <meta property="og:image" content="marketing seo image.png">
  <meta property="og:image:alt" content="Speech to Sign marketing banner">
  <meta property="og:image" content="logo (2).png">
  <meta property="og:image:alt" content="Speech to Sign logo">
  <meta property="og:image" content="Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png">
  <meta property="og:image:alt" content="Speech to Sign app icon">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@RTSolutions">
  <meta name="twitter:title" content="Speech to Sign">
  <meta name="twitter:description" content="Convert speech and text to sign visuals instantly.">
  <meta name="twitter:image" content="marketing seo image.png">
  <meta name="twitter:image:alt" content="Speech to Sign marketing banner">
  <meta name="theme-color" content="#0f7f88">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Speech to Sign">
  <link rel="canonical" href="./">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="preload" as="image" href="marketing seo image.png">
  <link rel="preload" as="image" href="logo (2).png">
  <link rel="preload" as="image" href="Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png">
  <link rel="icon" type="image/png" href="Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png">
  <link rel="shortcut icon" href="Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png">
  <link rel="icon" type="image/png" sizes="192x192" href="Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png">
  <link rel="apple-touch-icon" href="Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png">
  <title>Speech to Sign</title>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Speech to Sign",
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Web",
    "description": "Speech to Sign converts spoken or typed words into sign-language visuals with GIF playback and smart fallback modes.",
    "url": "./",
    "image": [
      "marketing seo image.png",
      "logo (2).png",
      "Gemini_Generated_Image_x0oe4fx0oe4fx0oe.png"
    ],
    "publisher": {
      "@type": "Organization",
      "name": "RT Solutions",
      "logo": {
        "@type": "ImageObject",
        "url": "logo (2).png"
      }
    }
  }
  </script>
  <style>
    :root{--bg:#eef4fb;--card:#fff;--line:#d8e3ef;--ink:#122334;--muted:#506173;--a:#0f7f88;--a2:#0a656c;--bg-grad:linear-gradient(165deg,#f4efe2,#dce9f7 50%,#edf8f1);--soft:#f8fbff;--show-bg:linear-gradient(180deg,#edf6ff,#eefaf7);--show-border:#95aec7;--img-border:#bed1e3;--input-bg:#fff;--chip-bg:#fff;--moon-glow:radial-gradient(circle at 30% 30%,rgba(255,225,150,.55),rgba(255,225,150,.12) 55%,transparent 70%);--moon-crescent:#f9e3a6;--tag-border:rgba(160,130,70,.35);--tag-bg:linear-gradient(135deg,rgba(255,244,208,.88),rgba(223,243,231,.9));--tag-ink:#6a5520}
    *{box-sizing:border-box}html,body{margin:0}
    html{-webkit-text-size-adjust:100%}
    body{font-family:Segoe UI,Tahoma,sans-serif;color:var(--ink);background:var(--bg-grad);overflow-x:hidden}
    body.theme-ramadan-dawn{--bg:#eef4fb;--card:#fff;--line:#d8e3ef;--ink:#122334;--muted:#506173;--a:#0f7f88;--a2:#0a656c;--bg-grad:linear-gradient(165deg,#f4efe2,#dce9f7 50%,#edf8f1);--soft:#f8fbff;--show-bg:linear-gradient(180deg,#edf6ff,#eefaf7);--show-border:#95aec7;--img-border:#bed1e3;--input-bg:#fff;--chip-bg:#fff;--moon-glow:radial-gradient(circle at 30% 30%,rgba(255,225,150,.55),rgba(255,225,150,.12) 55%,transparent 70%);--moon-crescent:#f9e3a6;--tag-border:rgba(160,130,70,.35);--tag-bg:linear-gradient(135deg,rgba(255,244,208,.88),rgba(223,243,231,.9));--tag-ink:#6a5520}
    body.theme-midnight{--bg:#0f1620;--card:#172230;--line:#2d4054;--ink:#e7eef8;--muted:#a9b8c8;--a:#2cb7c1;--a2:#95f1f8;--bg-grad:radial-gradient(1200px 620px at 85% -10%,rgba(255,210,120,.14),transparent 60%),linear-gradient(160deg,#0d1420,#1a2735);--soft:#1c2a3a;--show-bg:linear-gradient(180deg,#1a2a3a,#1a312e);--show-border:#46607a;--img-border:#4f6b87;--input-bg:#1a2735;--chip-bg:#1a2735;--moon-glow:radial-gradient(circle at 30% 30%,rgba(255,215,130,.72),rgba(255,215,130,.16) 55%,transparent 72%);--moon-crescent:#ffe7a8;--tag-border:rgba(240,200,120,.35);--tag-bg:linear-gradient(135deg,rgba(96,78,34,.45),rgba(22,62,57,.5));--tag-ink:#f6ddab}
    body.theme-oasis{--bg:#e9f8f2;--card:#ffffff;--line:#cfe8dd;--ink:#12342d;--muted:#4b6c63;--a:#137a63;--a2:#0d5e4d;--bg-grad:linear-gradient(165deg,#ebfbf5,#d7efe7 50%,#f4fbf8);--soft:#f3fcf8;--show-bg:linear-gradient(180deg,#e9fbf4,#f5fcfa);--show-border:#8fbfad;--img-border:#b6dccc;--input-bg:#fff;--chip-bg:#fff;--moon-glow:radial-gradient(circle at 30% 30%,rgba(201,246,226,.8),rgba(105,198,160,.18) 55%,transparent 75%);--moon-crescent:#b3f0d5;--tag-border:rgba(53,140,112,.3);--tag-bg:linear-gradient(135deg,rgba(210,248,231,.9),rgba(236,252,245,.92));--tag-ink:#1a654f}
    body.theme-sunset{--bg:#fff1e8;--card:#fff9f4;--line:#f2d7c8;--ink:#4a2a24;--muted:#7f5c52;--a:#c05d2d;--a2:#8e3f1f;--bg-grad:linear-gradient(165deg,#fff2e8,#ffe1cf 50%,#ffe9d9);--soft:#fff6ef;--show-bg:linear-gradient(180deg,#fff1e7,#fff7f0);--show-border:#e1b199;--img-border:#efc9b4;--input-bg:#fffaf5;--chip-bg:#fffaf5;--moon-glow:radial-gradient(circle at 30% 30%,rgba(255,196,145,.78),rgba(255,150,102,.2) 55%,transparent 74%);--moon-crescent:#ffd2a6;--tag-border:rgba(191,103,54,.34);--tag-bg:linear-gradient(135deg,rgba(255,229,207,.95),rgba(255,245,234,.96));--tag-ink:#8b4324}
    body.theme-royal{--bg:#f2f1ff;--card:#ffffff;--line:#ddd8ff;--ink:#1f2250;--muted:#5d6293;--a:#4f56c8;--a2:#343ba8;--bg-grad:linear-gradient(165deg,#f2f1ff,#e4e7ff 50%,#edf3ff);--soft:#f7f8ff;--show-bg:linear-gradient(180deg,#eef1ff,#f3f7ff);--show-border:#a2a8e6;--img-border:#c3c8f0;--input-bg:#fff;--chip-bg:#fff;--moon-glow:radial-gradient(circle at 30% 30%,rgba(191,203,255,.78),rgba(123,138,236,.2) 55%,transparent 74%);--moon-crescent:#d7dcff;--tag-border:rgba(97,104,193,.33);--tag-bg:linear-gradient(135deg,rgba(229,232,255,.93),rgba(241,244,255,.95));--tag-ink:#3b429d}
    body.theme-neon-grid{--bg:#080b16;--card:#0e1326;--line:#1e2c4b;--ink:#dff8ff;--muted:#8fb8c8;--a:#00e6b8;--a2:#71ffe2;--bg-grad:linear-gradient(160deg,#070b18,#0b1530 45%,#101d38);--soft:#121b32;--show-bg:linear-gradient(180deg,#10213a,#102d36);--show-border:#2a6d88;--img-border:#2d7390;--input-bg:#0f1a30;--chip-bg:#0f1a30;--moon-glow:radial-gradient(circle at 30% 30%,rgba(122,244,255,.7),rgba(0,255,214,.14) 56%,transparent 74%);--moon-crescent:#8ffff0;--tag-border:rgba(79,244,221,.35);--tag-bg:linear-gradient(135deg,rgba(15,54,64,.7),rgba(7,40,63,.72));--tag-ink:#9dffef}
    body.theme-paper{--bg:#f8f1e4;--card:#fffdf7;--line:#d5c7aa;--ink:#3a2f21;--muted:#705f49;--a:#8a6a32;--a2:#6f5224;--bg-grad:linear-gradient(170deg,#f7efe1,#efe4cd 60%,#f8f1e3);--soft:#fefaf0;--show-bg:linear-gradient(180deg,#f7eddc,#fbf6ea);--show-border:#bea67a;--img-border:#cfba95;--input-bg:#fffdf8;--chip-bg:#fffef9;--moon-glow:radial-gradient(circle at 30% 30%,rgba(232,202,148,.68),rgba(173,132,60,.16) 54%,transparent 75%);--moon-crescent:#e9cf9e;--tag-border:rgba(134,104,56,.33);--tag-bg:linear-gradient(135deg,rgba(252,242,221,.93),rgba(247,235,208,.93));--tag-ink:#6f5424}
    body.theme-mono{--bg:#ececec;--card:#ffffff;--line:#cfcfcf;--ink:#1f1f1f;--muted:#5e5e5e;--a:#2f2f2f;--a2:#111;--bg-grad:linear-gradient(160deg,#f4f4f4,#e3e3e3 55%,#f2f2f2);--soft:#fafafa;--show-bg:linear-gradient(180deg,#f2f2f2,#f7f7f7);--show-border:#a7a7a7;--img-border:#bfbfbf;--input-bg:#fff;--chip-bg:#fff;--moon-glow:radial-gradient(circle at 30% 30%,rgba(170,170,170,.5),rgba(102,102,102,.12) 56%,transparent 74%);--moon-crescent:#cfcfcf;--tag-border:rgba(104,104,104,.33);--tag-bg:linear-gradient(135deg,rgba(238,238,238,.95),rgba(246,246,246,.95));--tag-ink:#444}
    body.theme-forest-noir{--bg:#0b1712;--card:#13221a;--line:#2b4337;--ink:#d8f0e1;--muted:#8db29d;--a:#4cb980;--a2:#9df5c5;--bg-grad:linear-gradient(165deg,#0a1711,#11251b 48%,#143329);--soft:#182b22;--show-bg:linear-gradient(180deg,#163225,#133127);--show-border:#3f7e66;--img-border:#4d8a74;--input-bg:#13261e;--chip-bg:#13261e;--moon-glow:radial-gradient(circle at 30% 30%,rgba(179,255,215,.66),rgba(74,190,132,.14) 56%,transparent 74%);--moon-crescent:#c7ffe1;--tag-border:rgba(117,216,169,.34);--tag-bg:linear-gradient(135deg,rgba(26,72,51,.65),rgba(18,53,40,.68));--tag-ink:#cbffe7}
    body.theme-candy-pop{--bg:#fff0f8;--card:#ffffff;--line:#f5bfd8;--ink:#5d2450;--muted:#8f4d7d;--a:#ff4ea1;--a2:#d42f7f;--bg-grad:linear-gradient(165deg,#ffeefd,#ffd7ec 52%,#ffe8f5);--soft:#fff4fa;--show-bg:linear-gradient(180deg,#ffeef8,#fff6fb);--show-border:#ee9ec7;--img-border:#f5b9d9;--input-bg:#fff;--chip-bg:#fff;--moon-glow:radial-gradient(circle at 30% 30%,rgba(255,174,218,.74),rgba(255,97,187,.16) 55%,transparent 74%);--moon-crescent:#ffc4e6;--tag-border:rgba(226,81,158,.35);--tag-bg:linear-gradient(135deg,rgba(255,225,242,.95),rgba(255,241,249,.95));--tag-ink:#a32069}
    .splash{position:fixed;inset:0;z-index:3000;background:#fff;display:grid;place-items:center;padding:20px;opacity:1;visibility:visible;transition:opacity .3s ease,visibility .3s ease}
    .splash img{width:min(980px,92vw);max-height:88vh;object-fit:contain}
    .splash.hide{opacity:0;visibility:hidden}
    .page{min-height:100vh;padding:clamp(8px,2.5vw,20px);display:flex;align-items:center;justify-content:center}
    .card{width:min(1020px,100%);background:var(--card);border:1px solid var(--line);border-radius:18px;box-shadow:0 20px 40px rgba(18,35,52,.14);padding:clamp(12px,2.2vw,22px)}
    .head{text-align:center;margin-bottom:12px;position:relative}.head h1{margin:0 0 4px;font-size:clamp(1.35rem,4.8vw,2rem)}.head p{margin:0;color:var(--muted)}
    .head::before{content:"";position:absolute;right:8%;top:-16px;width:58px;height:58px;border-radius:50%;background:var(--moon-glow);pointer-events:none}
    .head::after{content:"";position:absolute;right:10%;top:-2px;width:24px;height:24px;border-radius:50%;background:radial-gradient(circle at 70% 50%,transparent 49%,var(--moon-crescent) 51% 66%,transparent 68%);pointer-events:none}
    .ramadanTag{display:inline-block;margin:8px auto 0;padding:6px 12px;border-radius:999px;border:1px solid var(--tag-border);background:var(--tag-bg);color:var(--tag-ink);font-size:.74rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase}
    .topToggles{display:flex;align-items:center;justify-content:center;gap:10px;margin:8px 0 12px;flex-wrap:wrap}
    .langTop{display:flex;justify-content:center}
    .langTop .tog{width:min(360px,100%);background:var(--soft);border:1px solid var(--line);border-radius:12px;padding:6px}
    .langTop .tog button{min-height:38px}
    .themePick{display:flex;align-items:center;gap:8px;background:var(--soft);border:1px solid var(--line);border-radius:12px;padding:6px 8px}
    .themePick label{font-size:.72rem;font-weight:700;letter-spacing:.04em;text-transform:uppercase;color:var(--muted)}
    .themePick select{min-height:34px;border-radius:9px;padding:6px 28px 6px 10px;font-size:.9rem}
    .logo{width:clamp(64px,12vw,90px);height:auto;display:block;margin:0 auto 8px}
    .controls{display:grid;place-items:center;gap:8px;margin-bottom:12px}
    .mic{width:80px;height:80px;border-radius:50%;border:none;background:linear-gradient(145deg,#4facfe,#00f2fe);box-shadow:0 10px 20px rgba(74,144,226,.3);display:grid;place-items:center;cursor:pointer;transition:.3s}
    .mic:hover{transform:scale(1.05);box-shadow:0 15px 25px rgba(74,144,226,.4)}.mic.listening{animation:pulse 1.5s infinite}.mic svg{width:32px;height:32px;fill:#fff}
    .status{min-height:20px;font-weight:700;color:var(--muted)}.status.listening{color:var(--a2)}.status.processing{color:#8a5a00}.status.error{color:#b43f34}
    .settings{display:grid;grid-template-columns:1fr;gap:8px;margin-bottom:12px}
    .set{background:var(--soft);border:1px solid var(--line);border-radius:12px;padding:10px}.set label{display:block;font-size:.78rem;font-weight:700;letter-spacing:.04em;text-transform:uppercase;color:var(--muted);margin-bottom:8px}
    .tog{display:grid;grid-template-columns:1fr 1fr;gap:8px}.tog button{min-height:40px;border-radius:10px;border:1px solid var(--line);background:var(--chip-bg);color:var(--ink);font-weight:700;cursor:pointer;padding:0 8px;white-space:nowrap}.tog button.on{border-color:var(--a);background:rgba(44,183,193,.18);color:var(--a2)}
    .manual{margin-bottom:12px}.manual label{display:block;font-weight:700;margin-bottom:8px}.row{display:grid;grid-template-columns:1fr;gap:8px}
    input,select{width:100%;min-height:46px;border:1px solid var(--line);border-radius:10px;padding:10px 12px;font-size:1rem;background:var(--input-bg);color:var(--ink)}
    .btn{width:100%;min-height:46px;border:none;border-radius:10px;background:var(--a);color:#fff;font-weight:700;padding:0 16px;cursor:pointer}
    .out{display:grid;grid-template-columns:1fr;gap:10px}.blk{background:var(--soft);border:1px solid var(--line);border-radius:12px;padding:12px}.blk h2{margin:0 0 8px;font-size:1rem}
    .blkHead{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px}
    .blkHead h2{margin:0}
    .iconBtn{width:36px;height:36px;border:1px solid var(--line);border-radius:10px;background:var(--chip-bg);color:var(--ink);display:grid;place-items:center;cursor:pointer}
    .iconBtn svg{width:18px;height:18px;fill:currentColor}
    .iconBtn:disabled{opacity:.5;cursor:not-allowed}
    .trans{min-height:28px;overflow-wrap:anywhere}.show{min-height:clamp(150px,30vw,220px);border:1px dashed var(--show-border);border-radius:12px;background:var(--show-bg);display:flex;align-items:center;justify-content:center;padding:12px;text-align:center}
    .show img{width:min(340px,100%);max-height:220px;border-radius:10px;border:1px solid var(--img-border);background:var(--chip-bg);box-shadow:0 10px 20px rgba(20,36,51,.16)}
    .tok{margin-top:8px;min-height:21px;color:var(--muted);font-weight:700}.ph{color:var(--muted)}
    .tcard{min-width:140px;min-height:110px;border:1px solid var(--img-border);border-radius:10px;background:var(--chip-bg);display:grid;place-items:center;padding:10px}
    .tcard b{font-size:.8rem;color:var(--muted);display:block}.tcard span{font-weight:700;color:var(--a2);text-transform:uppercase;word-break:break-word}
    .act{margin-top:12px;display:flex;justify-content:center}.clear{width:100%;max-width:240px;min-height:44px;border-radius:12px;border:2px solid var(--a);background:#fff;color:var(--a2);font-weight:700;cursor:pointer}
    .footer{padding:0 clamp(8px,2vw,14px) clamp(10px,2vw,14px)}.credit{margin:auto;max-width:1020px;padding:1rem;border-top:1px solid rgba(20,36,51,.12);text-align:center;background:linear-gradient(135deg,rgba(15,127,136,.15),rgba(255,225,170,.45));border-radius:14px}
    .credit a{text-decoration:none;color:inherit;display:inline-block}.credit p{margin:0 0 6px;font-size:.72rem;letter-spacing:2.2px;text-transform:uppercase;opacity:.65}.credit strong{display:inline-block;padding:.38rem .9rem;border-radius:999px;border:1px solid rgba(20,36,51,.25)}
    body.theme-neon-grid{font-family:"Trebuchet MS",Verdana,sans-serif}
    body.theme-neon-grid .card{border-radius:8px;box-shadow:0 0 0 1px rgba(0,255,214,.15),0 0 34px rgba(0,255,214,.1)}
    body.theme-neon-grid .mic{background:linear-gradient(145deg,#00d7ff,#00ff9f);box-shadow:0 0 0 1px rgba(0,255,214,.4),0 12px 26px rgba(0,255,214,.25)}
    body.theme-neon-grid .blk{border-style:dashed}
    body.theme-paper{font-family:Georgia,"Times New Roman",serif}
    body.theme-paper .card{border-radius:24px;border-width:2px;box-shadow:0 6px 0 rgba(140,113,66,.18)}
    body.theme-paper .blk{border-style:dotted}
    body.theme-paper .btn{border-radius:2px}
    body.theme-mono{font-family:"Segoe UI",Tahoma,sans-serif}
    body.theme-mono .card{border-radius:6px;box-shadow:0 8px 22px rgba(30,30,30,.12)}
    body.theme-mono .mic{background:linear-gradient(145deg,#5a5a5a,#2f2f2f)}
    body.theme-forest-noir{font-family:"Palatino Linotype","Book Antiqua",serif}
    body.theme-forest-noir .card{border-radius:20px;box-shadow:0 24px 44px rgba(0,0,0,.28)}
    body.theme-forest-noir .btn{background:linear-gradient(135deg,#3ea76f,#2f7a53)}
    body.theme-candy-pop{font-family:"Verdana","Trebuchet MS",sans-serif}
    body.theme-candy-pop .card{border-radius:28px;box-shadow:0 20px 42px rgba(255,78,161,.18)}
    body.theme-candy-pop .mic{background:linear-gradient(145deg,#ff7cc1,#ff4ea1)}
    body.theme-candy-pop .btn{background:linear-gradient(135deg,#ff63af,#ff3f97)}
    .fade{animation:fin .22s ease}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(0,242,254,.7)}70%{box-shadow:0 0 0 20px rgba(0,242,254,0)}100%{box-shadow:0 0 0 0 rgba(0,242,254,0)}}
    @keyframes fin{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}
    @media(min-width:720px){.settings{grid-template-columns:1fr 1fr}.row{grid-template-columns:1fr auto}.btn{width:auto;min-width:170px}}
    @media(max-width:720px){
      .head::before{
        right:4px;
        top:-10px;
        width:42px;
        height:42px;
      }
      .head::after{
        right:10px;
        top:-1px;
        width:18px;
        height:18px;
      }
      #signBlock{
        position:sticky;
        top:8px;
        z-index:20;
        border-color:#b8ccdf;
        box-shadow:0 10px 22px rgba(18,35,52,.12);
      }
      #signBlock h2{
        margin-bottom:6px;
      }
      #signBlock .show{
        min-height:140px;
      }
      #signBlock .show img{
        max-height:145px;
      }
    }
    @media(max-width:420px){.page{padding:8px}.card{border-radius:14px}.head h1{font-size:1.25rem}.head p{font-size:.9rem}.show img{max-height:160px}.credit strong{font-size:.88rem;padding:.34rem .8rem}.head::before{right:2px;top:-8px;width:34px;height:34px}.head::after{right:7px;top:0;width:14px;height:14px}}
    @media(min-width:1200px){.card{padding:24px}}
  </style>
</head>
<body class="theme-ramadan-dawn">
  <div id="entrySplash" class="splash" aria-hidden="true"><img src="marketing seo image.png" alt="Speech to Sign marketing"></div>
  <main class="page">
    <section class="card">
      <header class="head">
        <img class="logo" src="logo (2).png" alt="Speech to Sign logo">
        <h1>Speech to Sign</h1>
        <p>Speak and see it in sign language</p>
        <p class="ramadanTag">Ramadan Kareem</p>
        <div class="topToggles">
          <div class="langTop" role="group" aria-label="Language toggle">
            <div class="tog">
              <button id="enLangBtn" class="on" aria-pressed="true">English</button>
              <button id="soLangBtn" aria-pressed="false">Somali</button>
            </div>
          </div>
          <div class="themePick">
            <label for="themeSel">Theme</label>
            <select id="themeSel" aria-label="Choose visual theme">
              <option value="ramadan-dawn">Ramadan Dawn</option>
              <option value="midnight">Midnight</option>
              <option value="oasis">Oasis</option>
              <option value="sunset">Sunset</option>
              <option value="royal">Royal</option>
              <option value="neon-grid">Neon Grid</option>
              <option value="paper">Paper</option>
              <option value="mono">Mono</option>
              <option value="forest-noir">Forest Noir</option>
              <option value="candy-pop">Candy Pop</option>
            </select>
          </div>
        </div>
      </header>
      <section class="controls">
        <button id="micBtn" class="mic" aria-label="Start speech recognition">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
        </button>
        <p id="status" class="status">Idle</p>
      </section>
      <section class="out">
        <div id="textBlock" class="blk"><h2>Recognized Text</h2><p id="trans" class="trans">Click the microphone and start speaking.</p></div>
        <div id="signBlock" class="blk">
          <div class="blkHead">
            <h2>Sign Playback</h2>
            <button id="repeatBtn" class="iconBtn" type="button" aria-label="Repeat sign playback" title="Repeat sign playback" disabled>
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M17 1l4 4-4 4V6H8a3 3 0 0 0-3 3v1H3V9a5 5 0 0 1 5-5h9V1zM7 23l-4-4 4-4v3h9a3 3 0 0 0 3-3v-1h2v1a5 5 0 0 1-5 5H7v3z"/></svg>
            </button>
          </div>
          <div id="show" class="show"><p class="ph">Signs will appear here one by one.</p></div>
          <p id="tok" class="tok"></p>
        </div>
      </section>
      <section class="settings">
        <div class="set"><label>Output</label><div class="tog"><button id="gifBtn" class="on">GIFs</button><button id="textBtn">Text</button></div></div>
        <div class="set"><label>Fallback</label><div class="tog"><button id="smartBtn" class="on">Smart</button><button id="alphaBtn">Alphabet</button></div></div>
      </section>
      <select id="langSel" style="position:absolute;left:-9999px;opacity:0;pointer-events:none" aria-hidden="true" tabindex="-1"><option value="en-US">English</option><option value="so-SO">Somali</option></select>
      <section class="manual"><label for="input">Type text to translate</label><div class="row"><input id="input" placeholder="Example: hello, i love you"><button id="translate" class="btn">Translate Text</button></div></section>
      <section class="act"><button id="clear" class="clear">Clear</button></section>
    </section>
  </main>
  <footer class="footer"><div class="credit"><a href="https://raazimtech.github.io/Raazim-tech/" target="_blank" rel="noopener"><p>Made By</p><strong>RT Solutions</strong></a></div></footer>

  <script>
  (() => {
    const el = {
      mic: document.getElementById("micBtn"), status: document.getElementById("status"), input: document.getElementById("input"),
      translate: document.getElementById("translate"), trans: document.getElementById("trans"), show: document.getElementById("show"),
      tok: document.getElementById("tok"), clear: document.getElementById("clear"), gifBtn: document.getElementById("gifBtn"),
      textBtn: document.getElementById("textBtn"), smartBtn: document.getElementById("smartBtn"), alphaBtn: document.getElementById("alphaBtn"),
      langSel: document.getElementById("langSel"), enLangBtn: document.getElementById("enLangBtn"), soLangBtn: document.getElementById("soLangBtn"),
      themeSel: document.getElementById("themeSel"), repeatBtn: document.getElementById("repeatBtn")
    };

    const SIGN_FILES = [
      "100.gif","1000.gif","all.gif","allergic.gif","always.gif","americansignlanguage hello GIF.gif","baby.gif","bad.gif","book.gif","brother  sister.gif",
      "brother.gif","busy.gif","cannot.gif","child.gif","come.gif","continue.gif","cool.gif","death.gif","dont understand.gif","don't understand.gif",
      "each.gif","excuse me.gif","family.gif","fast.gif","father.gif","favourite.gif","fine.gif","free.gif","friend.gif","give.gif","good.gif","gorilla.gif",
      "Happy I Love You GIF by joeyahlbum.gif","happy sign language GIF by signtime.gif","happy sign language GIF.gif","hate that.gif","hate.gif","he.gif","her.gif","holiday.gif","home.gif","hope.gif",
      "how.gif","how many.gif","hungry.gif","i want.gif","i gif.gif","in    out.gif","introduce sign language GIF.gif","it.gif","kids or kid both variation.gif","kind.gif","later.gif",
      "lie.gif","like.gif","long.gif","mad.gif","Marry Sign Language GIF.gif","me.gif","mean.gif","meet.gif","mine.gif","monkey.gif","more.gif","mother.gif",
      "my.gif","nervous.gif","none.gif","not.gif","now.gif","pain.gif","parents.gif","sad sign language GIF.gif","see watch.gif","see you.gif","seriously.gif","shes polite.gif",
      "shy.gif","sick of.gif","sick sign language GIF.gif","Sign Language Change GIF.gif","sign language cry GIF.gif","sign language love GIF.gif","Sign Language Month GIF.gif","sign language name GIF.gif",
      "sign language numbers GIF.gif","Sign Language Play GIF.gif","Sign Language Put GIF.gif","Sign Language School GIF.gif","Sign Language Sgsl GIF.gif","Sign Language Stand GIF.gif",
      "Sign Language Time GIF.gif","Sign Language Wait GIF.gif","Sign Language Walk GIF.gif","Sign Language Week GIF.gif","sign language what GIF.gif","Sign Language Year GIF.gif",
      "Sign Language Yes GIF by @InvestInAccess.gif","sign no GIF by signtime.gif","sign please GIF by signtime.gif","sign yes GIF by signtime.gif","sister.gif","somebody.gif","something.gif",
      "sorry sign language GIF by signtime.gif","spelling or alphabet.gif","Stay Home Sign Language GIF.gif","sucess.gif","super.gif","thank u.gif","their.gif","toilet.gif","us.gif","water.gif",
      "we.gif","welcome.gif","when.gif","where.gif","which.gif","who.gif","wife.gif","wonderful.gif","you.gif","your.gif"
    ];
    const uniq = (arr) => [...new Set(arr.map(v => (v || "").trim()).filter(Boolean))];
    const fileToKey = (name) => {
      const raw = name.toLowerCase()
        .replace(/\.gif$/i, "")
        .replace(/@investinaccess/g, " ")
        .replace(/\bgif by\b.*$/i, " ")
        .replace(/\bgif\b/gi, " ")
        .replace(/\bsign language\b/gi, " ")
        .replace(/\bsgsl\b/gi, " sign ")
        .replace(/'/g, "")
        .replace(/[^a-z0-9 ]+/g, " ")
        .replace(/\s+/g, " ")
        .trim();
      const fixed = {
        "americansignlanguage hello": "hello",
        "happy i love you": "i love you",
        "introduce": "introduce",
        "kids or kid both variation": "kid",
        "marry": "marry",
        "shes polite": "she is polite",
        "sign no": "no",
        "sign yes": "yes",
        "sign please": "please",
        "sucess": "success",
        "thank u": "thank you"
      };
      return fixed[raw] || raw;
    };
    const SIGN = {};
    SIGN_FILES.forEach((file) => {
      const key = fileToKey(file);
      if (!SIGN[key]) SIGN[key] = [];
      SIGN[key].push(file);
    });

    const SO_BASE = {
      "100":"boqol","1000":"kun","all":"dhammaan","allergic":"xasaasiyad","always":"mar walba","baby":"ilmo","bad":"xun","book":"buug","brother":"walaal lab",
      "brother sister":"walaal","busy":"mashquul","cannot":"ma karo","child":"cunug","come":"kaalay","continue":"sii wad","cool":"fiican","death":"geeri",
      "dont understand":"ma fahmin","each":"mid kasta","excuse me":"i raali ahow","family":"qoys","fast":"dhakhso","father":"aabe","favourite":"ugu jeclaan",
      "fine":"wanaagsan","free":"xor","friend":"saaxiib","give":"sii","good":"wanaag","gorilla":"gorilla","hate":"neceb","hate that":"taas waan necbahay","he":"isaga","hello":"salaan","her":"iyada",
      "happy":"faraxsan","holiday":"fasax","home":"guri","hope":"rajo","how":"sidee","how many":"imisa","hungry":"gaajaysan","i":"aniga","i love you":"waan ku jeclahay",
      "i want":"waan rabaa","in out":"gudaha bannaanka","introduce":"is baro","it":"wax","kid":"ilmo","kind":"naxariis","later":"danbe","lie":"been","like":"jecel",
      "long":"dheer","mad":"caraysan","marry":"guurso","mean":"xun","meet":"la kulan","me":"aniga","mine":"kayga","monkey":"daanyeer","more":"inbadan","mother":"hooyo",
      "my":"kayga","nervous":"walwal","none":"midna ma jiro","no":"maya","not":"maya","now":"hadda","numbers":"tirooyin","pain":"xanuun","parents":"waalidiin",
      "play":"ciyaar","please":"fadlan","put":"dhig","sad":"murugaysan","see watch":"arag daawo","see you":"ku arki doonaa","seriously":"runtii","she is polite":"iyada waa edeb",
      "shy":"xishood","sick":"xanuunsan","sick of":"ka daalay","sign":"calaamad","sorry":"waan ka xumahay","somebody":"qof","something":"wax","spelling or alphabet":"higgaad ama alifbeeto",
      "stand":"istaag","stay home":"guriga joog","success":"guul","super":"aad u fiican","sister":"walaal dhedig","thank you":"mahadsanid","their":"kooda","time":"waqti",
      "toilet":"musqul","us":"annaga","wait":"sug","walk":"socod","water":"biyo","we":"annaga","week":"usbuuc","welcome":"soo dhawoow","when":"goorma","where":"xagee",
      "which":"kee","who":"yaa","wife":"xaas","wonderful":"cajiib","year":"sano","yes":"haa","you":"adiga","your":"kaa","what":"maxay","love":"jacayl","school":"dugsi",
      "change":"beddel","cry":"ooy"
    };
    const SO = {};
    Object.keys(SIGN).forEach((key) => { SO[key] = SO_BASE[key] || key; });

    const EN_BASE_VARIANTS = {
      "all":["all","everyone","everybody","everything","all of it"],
      "allergic":["allergic","allergy","allergies","reacting","reaction"],
      "book":["book","books","notebook","textbook","that book"],
      "child":["child","children","kid","kids","little one"],
      "death":["death","dead","died","passed away"],
      "father":["father","dad","daddy","papa"],
      "hate":["hate","hated","hates","dislike","can't stand"],
      "hate that":["hate that","i hate that","dont like that","do not like that"],
      "he":["he","him","that man","that guy"],
      "hello":["hello","hi","hey","heyy","hiya","yo","greetings","good morning","good evening"],
      "her":["her","hers","that woman","that girl"],
      "how":["how","how do","how can","how is","in what way"],
      "i":["i","me"],
      "i love you":["i love you","i luv you","love you","luv u","ily","i really love you"],
      "i want":["i want","want this","want that","i need","i would like"],
      "it":["it","this thing","that thing"],
      "kid":["kid","kids","child","children"],
      "kind":["kind","kindness","be kind","nice person"],
      "lie":["lie","lying","lied","not true","false statement"],
      "like":["like","liked","likes","enjoy","prefer"],
      "mean":["mean","means","what do you mean","meaning"],
      "mad":["mad","angry","upset","furious"],
      "mine":["mine","this is mine","it is mine","belongs to me","my own","that is mine","my book","my stuff"],
      "mother":["mother","mom","mum","mama"],
      "my":["my","my own","for me"],
      "no":["no","nope","nah","negative","not really","never"],
      "none":["none","nothing","no one","nobody"],
      "pain":["pain","painful","it hurts","hurt","aching","ache"],
      "parents":["parents","my parents","mother and father","mom and dad"],
      "please":["please","pls","plz","please help","please now","kindly"],
      "seriously":["seriously","for real","really seriously"],
      "shy":["shy","timid","bashful"],
      "sick of":["sick of","tired of","fed up","done with this"],
      "somebody":["somebody","someone","person"],
      "something":["something","anything","a thing"],
      "sorry":["sorry","so sorry","my bad","apologies","forgive me","pardon me"],
      "thank you":["thank you","thanks","thank u","thx","many thanks","thanks a lot"],
      "their":["their","theirs","belongs to them"],
      "us":["us","we all","our group"],
      "what":["what","what is","what now","which thing","what do you mean","what happened"],
      "who":["who","who is","who are you","who is that","who now","who there"],
      "wife":["wife","my wife","spouse"],
      "yes":["yes","yep","yeah","yup","sure","affirmative"],
      "you":["you","u","yourself"]
    };
    const EXTRA_CORRELATIONS = {
      "death":["die","dies","dying","deceased"],
      "allergic":["allergen","sensitive","sensitivity"],
      "always":["forever","everytime","each time"],
      "bad":["awful","terrible","poor"],
      "book":["read","reading","novel"],
      "busy":["occupied","swamped"],
      "cannot":["cant","unable","impossible"],
      "come":["arrive","arriving","came"],
      "continue":["keep going","resume","carry on"],
      "cool":["awesome","nice","great"],
      "each":["every","each one"],
      "fast":["quick","quickly","rapid"],
      "fine":["okay","ok","alright"],
      "free":["available","unlocked"],
      "friend":["buddy","pal"],
      "give":["hand","hand over","provide"],
      "good":["great","excellent","nice"],
      "happy":["glad","joyful"],
      "hate":["detest","loathe"],
      "home":["house"],
      "hope":["wish"],
      "hungry":["starving"],
      "kind":["gentle","helpful"],
      "later":["after","afterwards"],
      "like":["enjoy","love this"],
      "mad":["angry","annoyed","furious"],
      "more":["extra","additional"],
      "nervous":["anxious","worried"],
      "none":["nothing","nobody","noone"],
      "pain":["hurt","hurting","ache","aching"],
      "sad":["unhappy","down"],
      "seriously":["really","fr"],
      "shy":["timid","bashful"],
      "sick":["ill","unwell"],
      "sick of":["fed up","done with"],
      "somebody":["someone","person"],
      "something":["anything","thing"],
      "toilet":["bathroom","restroom","washroom"],
      "water":["drink water","h2o"],
      "welcome":["gladly welcome"],
      "wonderful":["amazing","fantastic"],
      "yes":["yeah","yep","yup"],
      "no":["nah","nope"]
    };
    Object.entries(EXTRA_CORRELATIONS).forEach(([key, arr]) => {
      EN_BASE_VARIANTS[key] = uniq((EN_BASE_VARIANTS[key] || []).concat(arr));
    });
    const SO_BASE_VARIANTS = {
      "hello":["salaan","salaam","asc","asalamu alaikum","asalaamu calaykum","iska warran"],
      "i love you":["waan ku jeclahay","waan ku jclhy","waan kuclahay","waan ku jecelahay","waan ku jacelahay","waan ku jeclahay adiga"],
      "dont understand":["ma fahmin","maan fahmin","ma fahmaayo","ma garanayo","waan wareersanahay","si fiican uma fahmin"],
      "thank you":["mahadsanid","mahadsantahay","waad mahadsantahay","aad baad u mahadsantahay","mahadcelin","mahadsanidin"],
      "yes":["haa","haye","waayahay","waa sax","waad saxantahay","ok"],
      "no":["maya","maya maya","diidmo","ma aha","marnaba","ma doonayo"],
      "please":["fadlan","fadlan i caawi","fadlan hadda","si naxariis leh","iiga raalli noqo","fadlann"],
      "good":["wanaag","fiican","aad u fiican","wacan","ok","sax"],
      "sorry":["waan ka xumahay","raali ahow","iiga raali noqo","cafis","aad baan uga xumahay","waan ka xumahay runtii"],
      "mine":["kayga","aniga leh","kan waa kayga","waxaan leeyahay","ii gaar ah","taas waa tayda"],
      "my":["kayga","tayda","aniga leh"],
      "book":["buug","buuga","buugga"],
      "child":["cunug","caruur","ilmo"],
      "father":["aabe","abbaha"],
      "mother":["hooyo","hooyada"],
      "hate":["neceb","waan necbahay","aan jeclayn"],
      "hate that":["taas waan necbahay","taas ma jecli"],
      "lie":["been","been sheeg","run ma aha"],
      "mad":["caraysan","xanaaqsan"],
      "sick of":["ka daalay","waan ka daalay","waan ka caajisay"],
      "wife":["xaas","xaaskeyga"],
      "their":["kooda","iyaga leh"],
      "us":["annaga","innaga"],
      "you":["adiga","adigaa"],
      "what":["maxay","waa maxay","maxaa","maxaa jira","maxaad tiri","maxaa dhacay"],
      "love":["jacayl","waan ku jeclahay","jaceyl","jeceyl","jacayl badan","waan jecelahay"],
      "school":["dugsi","iskuul","dugsiga","iskuulka","dugsi tag","dugsiga ayaan joogaa"],
      "me":["aniga","aniga ah","iga","aniga i","anigaa","naftayda"],
      "who":["yaa","waa kuma","kuma","yaa adiga","yaa taas","yaa halkaas"],
      "how":["sidee","sidee bay","sidee tahay","sidee loo","qaabkee"]
    };
    const buildAliases = (key) => {
      const soWord = SO[key] || key;
      const enTemplates = key.includes(" ")
        ? [key]
        : [key, `my ${key}`, `the ${key}`, `${key} please`];
      const en = uniq((EN_BASE_VARIANTS[key] || []).concat(enTemplates));
      const so = uniq((SO_BASE_VARIANTS[key] || []).concat([soWord, `fadlan ${soWord}`, `${soWord} ayaan rabaa`, `${soWord} hadda`, `${soWord} ma jiraa`, `${soWord} iga caawi`]));
      return uniq(en.concat(so));
    };
    const ALIAS = {};
    Object.keys(SIGN).forEach((key) => { ALIAS[key] = buildAliases(key); });
    const TEXT = {
      en: {
        idle: "Idle",
        listening: "Listening...",
        processing: "Processing...",
        showing: "Showing",
        defaultTranscript: "Click the microphone and start speaking.",
        defaultPlaceholder: "Signs will appear here one by one.",
        noMap: "No mappable signs found for the input.",
        emptyInput: "Please speak or type a sentence first.",
        waitingInput: "Waiting for valid text input.",
        noSpeech: "No speech detected. Please try again.",
        unsupported: "Speech recognition not supported in this browser. Please use Google Chrome.",
        micDenied: "Microphone permission denied. Please allow mic access in your browser.",
        micDeniedHelp: "Microphone permission is required.",
        noMic: "No microphone was detected. Connect a mic and try again.",
        noMicHelp: "No microphone available.",
        speechErr: "Speech recognition error",
        speechErrHelp: "Could not process speech input.",
        micBlocked: "Microphone blocked",
        micMissing: "No microphone",
        error: "Error",
        micStartFail: "Could not start microphone. Please allow mic access and try again.",
        micStartFailHelp: "Microphone start failed."
      },
      so: {
        idle: "Sug",
        listening: "Dhageysanaya...",
        processing: "Habaynaya...",
        showing: "Muujinaya",
        defaultTranscript: "Riix makarafoonka kadib hadal.",
        defaultPlaceholder: "Calaamadaha ayaa halkan ku soo muuqanaya mid mid.",
        noMap: "Ma helin calaamad ku habboon qoraalka.",
        emptyInput: "Fadlan hadal ama qor jumlad marka hore.",
        waitingInput: "Waxaan sugayaa qoraal sax ah.",
        noSpeech: "Hadal lama maqal. Fadlan mar kale isku day.",
        unsupported: "Aqoonsiga codka browser-kan ma taageero. Fadlan isticmaal Chrome.",
        micDenied: "Ogolaanshaha makarafoonka waa la diiday. Fadlan ogolow makarafoonka.",
        micDeniedHelp: "Makarafoon ogolaansho ayaa loo baahan yahay.",
        noMic: "Makarafoon lama helin. Ku xidh makarafoon kadib isku day mar kale.",
        noMicHelp: "Makarafoon lama heli karo.",
        speechErr: "Khalad aqoonsiga codka",
        speechErrHelp: "Gelinta codka lama farsameyn karin.",
        micBlocked: "Makarafoon xiran",
        micMissing: "Makarafoon ma jiro",
        error: "Khalad",
        micStartFail: "Makarafoonka lama bilaabi karin. Fadlan ogolow makarafoonka kadibna isku day mar kale.",
        micStartFailHelp: "Bilowga makarafoonka wuu fashilmay."
      }
    };

    const normalizeText = t => t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[.,!?;:"'()\-]/g," ").replace(/\s+/g," ").trim();
    const phraseMap = {}, singleWordMap = {}, aliasMap = {}, soAliasMap = {}, variantIndex = {};
    Object.entries(SIGN).forEach(([k,files]) => {
      const srcList = (Array.isArray(files) ? files : [files]).map((f) => encodeURI(f));
      phraseMap[k]={srcList,token:k};
      if (!k.includes(" ")) singleWordMap[k] = srcList;
    });
    Object.entries(ALIAS).forEach(([k,arr]) => arr.forEach(a => aliasMap[normalizeText(a)]=k));
    Object.entries(SO).forEach(([k,v]) => { soAliasMap[normalizeText(v)] = k; });
    const CLOSEST_WORD_MAP = {
      a: "", an: "", the: "", is: "", am: "", are: "", was: "", were: "", be: "", being: "", been: "",
      to: "", of: "", on: "", at: "", in: "", for: "", from: "", with: "", and: "", but: "", or: "",
      this: "", that: "", these: "", those: "",
      belongs: "mine", owned: "mine", ownership: "mine", myself: "me", gave: "give", given: "give", gives: "give",
      angry: "mad", anger: "mad", furious: "mad", upset: "mad",
      lied: "lie", lying: "lie", false: "lie", untrue: "lie",
      dislike: "hate", hated: "hate", hates: "hate",
      tired: "sick of", fed: "sick of",
      mom: "mother", mum: "mother", mommy: "mother", mama: "mother",
      dad: "father", daddy: "father", papa: "father",
      children: "child", kids: "kid", kiddo: "kid",
      hurts: "pain", hurting: "pain", painful: "pain", ache: "pain", aching: "pain",
      wants: "i want", want: "i want", wanted: "i want", needing: "i want", needs: "i want", need: "i want",
      wnat: "i want", waant: "i want", watn: "i want", wnt: "i want", wan: "i want",
      likes: "like", liked: "like", loving: "love",
      ours: "us", theirs: "their", hers: "her", his: "he",
      anybody: "somebody", anyone: "somebody", anything: "something", somebodys: "somebody",
      spouse: "wife", partner: "wife"
    };
    const SINGLE_KEYS = Object.keys(singleWordMap);
    const SINGLE_ALIAS_ENTRIES = Object.entries(aliasMap)
      .filter(([alias]) => !alias.includes(" "))
      .map(([alias, key]) => ({ alias, key }));
    const singular = (w) => {
      if (w.endsWith("ies") && w.length > 4) return `${w.slice(0, -3)}y`;
      if (w.endsWith("es") && w.length > 3) return w.slice(0, -2);
      if (w.endsWith("s") && w.length > 3) return w.slice(0, -1);
      return w;
    };
    const stem = (w) => {
      if (w.endsWith("ing") && w.length > 5) return w.slice(0, -3);
      if (w.endsWith("ed") && w.length > 4) return w.slice(0, -2);
      if (w.endsWith("ly") && w.length > 4) return w.slice(0, -2);
      return w;
    };
    const distance = (a, b) => {
      if (Math.abs(a.length - b.length) > 2) return 99;
      const dp = Array.from({length: a.length + 1}, () => Array(b.length + 1).fill(0));
      for (let i = 0; i <= a.length; i++) dp[i][0] = i;
      for (let j = 0; j <= b.length; j++) dp[0][j] = j;
      for (let i = 1; i <= a.length; i++) {
        for (let j = 1; j <= b.length; j++) {
          const cost = a[i - 1] === b[j - 1] ? 0 : 1;
          dp[i][j] = Math.min(
            dp[i - 1][j] + 1,
            dp[i][j - 1] + 1,
            dp[i - 1][j - 1] + cost
          );
        }
      }
      return dp[a.length][b.length];
    };
    const sharePrefix = (a, b) => {
      if (!a || !b) return false;
      if (a[0] !== b[0]) return false;
      if (Math.min(a.length, b.length) >= 4) return a.slice(0, 2) === b.slice(0, 2);
      return true;
    };
    const bestFuzzyKey = (word) => {
      const maxDist = word.length <= 5 ? 1 : 2;
      let bestKey = "";
      let bestDist = maxDist + 1;

      for (const key of SINGLE_KEYS) {
        if (!sharePrefix(word, key)) continue;
        const d = distance(word, key);
        if (d < bestDist) {
          bestDist = d;
          bestKey = key;
          if (d === 0) return bestKey;
        }
      }
      for (const { alias, key } of SINGLE_ALIAS_ENTRIES) {
        if (!sharePrefix(word, alias)) continue;
        const d = distance(word, alias);
        if (d < bestDist) {
          bestDist = d;
          bestKey = key;
          if (d === 0) return bestKey;
        }
      }
      return bestDist <= maxDist ? bestKey : "";
    };
    const resolveClosestToken = (word) => {
      const n = norm(word);
      if (!n) return "";
      if (singleWordMap[n]) return n;
      const alias = aliasMap[n];
      if (alias && (singleWordMap[alias] || phraseMap[alias])) return alias;
      const soAlias = soAliasMap[n];
      if (soAlias && (singleWordMap[soAlias] || phraseMap[soAlias])) return soAlias;
      const forms = uniq([n, singular(n), stem(n), singular(stem(n))]);
      for (const f of forms) {
        if (singleWordMap[f] || phraseMap[f]) return f;
        const mapped = CLOSEST_WORD_MAP[f];
        if (mapped && (singleWordMap[mapped] || phraseMap[mapped])) return mapped;
        if (mapped === "") return "";
      }
      // Avoid forcing very short words into unrelated signs (e.g. "how" -> "now").
      if (n.length <= 3) return "";
      return bestFuzzyKey(n);
    };

    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    let rec = null, listening=false, hadResult=false, manualStop=false, run=0, output="gif", fallback="smart", last="";
    const wait = ms => new Promise(r=>setTimeout(r,ms));
    const splash = document.getElementById("entrySplash");

    function setupSplash(){
      if(!splash) return;
      const holdMs = 2000;
      const fadeMs = 300;
      setTimeout(() => {
        splash.classList.add("hide");
        setTimeout(() => splash.remove(), fadeMs + 10);
      }, holdMs);
    }

    const setStatus = (kind,txt) => { el.status.className = `status ${kind}`.trim(); el.status.textContent = txt; };
    const norm = normalizeText;
    const esc = s => s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");
    const applyAliasMap = (input, map) => {
      let out = input;
      Object.keys(map).sort((a,b)=>b.length-a.length).forEach((key)=>{
        out = out.replace(new RegExp(`\\b${esc(key)}\\b`, "g"), map[key]);
      });
      return out;
    };
    const aliasNorm = t => {
      let n=norm(t).replace(/\bgoing to\b/g,"go").replace(/\bi am\b/g,"i");
      n = applyAliasMap(n, aliasMap);
      if (isSomali()) n = applyAliasMap(n, soAliasMap);
      return n;
    };
    const isSomali = () => (el.langSel?.value || "").toLowerCase().startsWith("so");
    const t = (key) => (isSomali() ? TEXT.so[key] : TEXT.en[key]);
    const displayToken = (token) => (isSomali() && SO[token] ? SO[token] : token);
    const localizeText = (text) => {
      if (!isSomali() || !text) return text;
      let out = text;
      Object.keys(SO).sort((a,b)=>b.length-a.length).forEach((k)=>{
        out = out.replace(new RegExp(`\\b${esc(k)}\\b`, "g"), SO[k]);
      });
      return out;
    };

    const clearShow = (m=t("defaultPlaceholder")) => { el.show.innerHTML=`<p class="ph">${m}</p>`; el.tok.textContent=""; };
    const tokenCard = (token,title="Text") => { el.show.innerHTML=`<div class="tcard fade"><div><b>${title}</b><span>${token}</span></div></div>`; };
    const updateRepeatState = () => { if (el.repeatBtn) el.repeatBtn.disabled = !last; };
    const alphaSources = (c) => [`assets/alphabet/${c}.gif`, encodeURI("spelling or alphabet.gif")];

    const queueFor = (words, forceAlpha) => {
      const q=[]; const max=3;
      for(let i=0;i<words.length;i++){
        const w=words[i];
        if(forceAlpha){ [...w].filter(c=>c>="a"&&c<="z").forEach(c=>q.push({srcList:alphaSources(c),token:c,display:c})); continue; }
        // Force "i love you" to play as three separate signs instead of the single phrase GIF.
        if (
          i + 2 < words.length &&
          words[i] === "i" &&
          words[i + 1] === "love" &&
          words[i + 2] === "you" &&
          singleWordMap.i &&
          singleWordMap.love &&
          singleWordMap.you
        ) {
          q.push({srcList:singleWordMap.i,token:"i",display:displayToken("i")});
          q.push({srcList:singleWordMap.love,token:"love",display:displayToken("love")});
          q.push({srcList:singleWordMap.you,token:"you",display:displayToken("you")});
          i += 2;
          continue;
        }
        // Keep "i want" stable even when "want" is misspelled by typing or speech recognition.
        if (
          i + 1 < words.length &&
          w === "i" &&
          phraseMap["i want"] &&
          (
            words[i + 1] === "want" ||
            resolveClosestToken(words[i + 1]) === "i want" ||
            distance(words[i + 1], "want") <= 1
          )
        ) {
          q.push({...phraseMap["i want"], display:displayToken("i want")});
          i += 1;
          continue;
        }
        let found=null, size=0;
        for(let s=max;s>=2;s--){ if(i+s>words.length) continue; const p=words.slice(i,i+s).join(" "); if(phraseMap[p]){found=p;size=s;break;} }
        if(found){ q.push({...phraseMap[found], display:displayToken(found)}); i+=size-1; continue; }
        if(singleWordMap[w]) { q.push({srcList:singleWordMap[w],token:w,display:displayToken(w)}); continue; }
        const closest = resolveClosestToken(w);
        if (closest) {
          if (singleWordMap[closest]) q.push({srcList:singleWordMap[closest],token:closest,display:displayToken(closest)});
          else if (phraseMap[closest]) q.push({...phraseMap[closest], display:displayToken(closest)});
          continue;
        }
        // In smart mode, don't force alphabet GIF spelling for unknown words.
        // Keep unmatched token as text when text output is enabled.
        if (output === "text") q.push({src:"",token:w,display:w,fallback:true,title:isSomali()?"Qoraal":"Text"});
      }
      return q;
    };

    const pickSrc = (token, srcList) => {
      if(!srcList?.length) return "";
      const i = variantIndex[token] || 0;
      variantIndex[token] = (i + 1) % srcList.length;
      return srcList[i];
    };

    const render = item => new Promise(res=>{
      if(output==="text"){ tokenCard(item.display || item.token,isSomali()?"Qoraal":"Text"); res(); return; }
      const srcList = item.srcList || (item.src ? [item.src] : []);
      if(item.fallback || !srcList.length){ res(); return; }
      let done=false;
      const fin=()=>{if(done)return;done=true;res();};
      const start = variantIndex[item.token] || 0;
      const tryLoad = (offset) => {
        if (done) return;
        if (offset >= srcList.length) { fin(); return; }
        const idx = (start + offset) % srcList.length;
        const src = srcList[idx];
        const img = new Image();
        let settled = false;
        const settle = (ok) => {
          if (settled || done) return;
          settled = true;
          if (ok) {
            variantIndex[item.token] = (idx + 1) % srcList.length;
            el.show.innerHTML = "";
            el.show.appendChild(img);
            fin();
          } else {
            tryLoad(offset + 1);
          }
        };
        img.className = "fade";
        img.alt = `Sign animation for ${item.token}`;
        img.onload = () => settle(true);
        img.onerror = () => settle(false);
        img.src = src;
        // Large local GIFs can take longer to decode; short timeouts skip valid signs.
        setTimeout(() => settle(false), 8000);
      };
      tryLoad(0);
    });

    async function play(words, forceAlpha=false){
      run++; const id=run; const q=queueFor(words, forceAlpha);
      if(!q.length){ clearShow(t("noMap")); setStatus("",t("idle")); return; }
      for(const item of q){ if(id!==run) return; el.tok.textContent=`${t("showing")}: ${item.display || item.token}`; await render(item); await wait(1800); }
      if(id===run) setStatus("",t("idle"));
    }

    function translate(raw){
      const normalized = aliasNorm(raw);
      if(!normalized){ el.trans.textContent=t("emptyInput"); clearShow(t("waitingInput")); setStatus("",t("idle")); return; }
      const req=/\b(spell|alphabet|letter|letters)\b/g;
      const clean=normalized.replace(req," ").replace(/\s+/g," ").trim(); const final=clean || normalized;
      const words=final.split(" ").filter(Boolean);
      last=final; updateRepeatState(); el.trans.textContent=localizeText(final); setStatus("processing",t("processing")); play(words, fallback==="alphabet");
    }

    function reset(){ run++; el.trans.textContent=t("defaultTranscript"); el.input.value=""; clearShow(); el.mic.classList.remove("listening"); el.mic.setAttribute("aria-label","Start speech recognition"); listening=false; hadResult=false; manualStop=false; last=""; updateRepeatState(); setStatus("",t("idle")); }
    const replay=()=>{ if(last) translate(last); };
    const tog=(on,off)=>{on.classList.add("on");off.classList.remove("on");on.setAttribute("aria-pressed","true");off.setAttribute("aria-pressed","false");};
    const THEME_KEY = "theme-name";
    const THEME_NAMES = ["ramadan-dawn","midnight","oasis","sunset","royal","neon-grid","paper","mono","forest-noir","candy-pop"];
    const applyTheme = (name) => {
      const next = THEME_NAMES.includes(name) ? name : "ramadan-dawn";
      document.body.classList.remove(...THEME_NAMES.map((t) => `theme-${t}`));
      document.body.classList.add(`theme-${next}`);
      if (el.themeSel) el.themeSel.value = next;
      try { localStorage.setItem(THEME_KEY, next); } catch {}
    };
    const initTheme = () => {
      let saved = "";
      try { saved = localStorage.getItem(THEME_KEY) || ""; } catch {}
      // Migrate old light/dark setting if present.
      if (!saved) {
        let legacy = "";
        try { legacy = localStorage.getItem("theme-mode") || ""; } catch {}
        if (legacy === "dark") saved = "midnight";
      }
      applyTheme(saved || "ramadan-dawn");
    };
    const setLangToggle = () => {
      if ((el.langSel?.value || "en-US").toLowerCase().startsWith("so")) tog(el.soLangBtn, el.enLangBtn);
      else tog(el.enLangBtn, el.soLangBtn);
    };

    function setupMic(){
      if(!SR){ el.trans.textContent=t("unsupported"); el.mic.disabled=true; setStatus("",t("idle")); return; }
      rec = new SR(); rec.lang=el.langSel?.value || "en-US"; rec.continuous=false; rec.interimResults=false; rec.maxAlternatives=1;
      rec.onstart=()=>{listening=true;hadResult=false;manualStop=false;el.mic.classList.add("listening");el.mic.setAttribute("aria-label","Stop speech recognition");setStatus("listening",t("listening"));};
      rec.onresult=(e)=>{hadResult=true; const heard=(e.results?.[0]?.[0]?.transcript||"").trim(); if(!heard){el.trans.textContent=t("noSpeech"); clearShow(t("noSpeech")); setStatus("",t("idle")); return;} translate(heard);};
      rec.onend=()=>{listening=false;el.mic.classList.remove("listening");el.mic.setAttribute("aria-label","Start speech recognition"); if(!hadResult && !manualStop){el.trans.textContent=t("noSpeech"); clearShow(t("noSpeech")); setStatus("",t("idle"));} manualStop=false;};
      rec.onerror=(e)=>{const err=e.error||"unknown-error";
        if(err==="not-allowed"||err==="service-not-allowed"){el.trans.textContent=t("micDenied"); clearShow(t("micDeniedHelp")); setStatus("error",t("micBlocked"));}
        else if(err==="audio-capture"){el.trans.textContent=t("noMic"); clearShow(t("noMicHelp")); setStatus("error",t("micMissing"));}
        else if(err==="no-speech"){el.trans.textContent=t("noSpeech"); clearShow(t("noSpeech")); setStatus("",t("idle"));}
        else{el.trans.textContent=`${t("speechErr")}: ${err}`; clearShow(t("speechErrHelp")); setStatus("error",t("error"));}
        listening=false;hadResult=false;manualStop=false;el.mic.classList.remove("listening");el.mic.setAttribute("aria-label","Start speech recognition");
      };
    }

    el.mic.addEventListener("click",()=>{ if(!rec) return; if(listening){manualStop=true;rec.stop();return;} try{rec.start();}catch{el.trans.textContent=t("micStartFail");clearShow(t("micStartFailHelp"));setStatus("",t("idle"));}});
    el.translate.addEventListener("click",()=>translate(el.input.value));
    el.input.addEventListener("keydown",e=>{if(e.key==="Enter"){e.preventDefault();translate(el.input.value);}});
    el.clear.addEventListener("click",()=>{ if(rec&&listening) rec.stop(); reset(); });
    el.gifBtn.addEventListener("click",()=>{output="gif";tog(el.gifBtn,el.textBtn);replay();});
    el.textBtn.addEventListener("click",()=>{output="text";tog(el.textBtn,el.gifBtn);replay();});
    el.smartBtn.addEventListener("click",()=>{fallback="smart";tog(el.smartBtn,el.alphaBtn);replay();});
    el.alphaBtn.addEventListener("click",()=>{fallback="alphabet";tog(el.alphaBtn,el.smartBtn);replay();});
    el.repeatBtn?.addEventListener("click",()=>{ replay(); });
    el.enLangBtn?.addEventListener("click",()=>{
      if(el.langSel.value === "en-US") return;
      el.langSel.value = "en-US";
      el.langSel.dispatchEvent(new Event("change"));
    });
    el.soLangBtn?.addEventListener("click",()=>{
      if(el.langSel.value === "so-SO") return;
      el.langSel.value = "so-SO";
      el.langSel.dispatchEvent(new Event("change"));
    });
    el.themeSel?.addEventListener("change",()=>{ applyTheme(el.themeSel.value); });
    el.langSel?.addEventListener("change",()=>{
      setLangToggle();
      if(!rec) return;
      rec.lang = el.langSel.value;
      if(!last){
        el.trans.textContent = t("defaultTranscript");
        clearShow();
        setStatus("", t("idle"));
      } else {
        replay();
      }
      if(listening){
        manualStop = true;
        rec.stop();
        setTimeout(()=>{ try { rec.start(); } catch {} }, 120);
      }
    });

    initTheme();
    setLangToggle();
    el.trans.textContent = t("defaultTranscript");
    clearShow(); updateRepeatState(); setStatus("",t("idle")); setupSplash(); setupMic();

    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(() => {});
      });
    }
  })();
  </script>
</body>
</html>
